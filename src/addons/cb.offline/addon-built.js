define("client",[],function(){var e=codebox.require("core/app"),t=codebox.require("core/box"),n=codebox.require("core/commands/menu"),r=codebox.require("core/commands/toolbar"),i=codebox.require("hr/hr"),s=codebox.require("models/command"),o=codebox.require("core/localfs"),u=codebox.require("utils/dialogs"),a=new s({},{title:"Changes",type:"menu",flags:"disabled"}),f=n.register("offline.changes",{title:"Changes",position:95,offline:!1}).menuSection([{title:"Recalcul Changes",offline:!1,action:function(){return o.sync()}},{id:"changes.apply",title:"Apply All Changes",offline:!1,action:function(){var e=o.changes.size();if(e==0)return;u.confirm("Do you really want to apply "+e+" changes?").then(function(e){if(!e)return;return o.changes.applyAll()})}}]).menuSection([a]);o.changes.on("add remove reset",function(){a.toggleFlag("disabled",o.changes.size()==0),a.menu.reset(o.changes.map(function(e){return e.command()}))});var l=r.register("offline.check",{title:"Check Connexion",offline:!0,icon:"bolt"},function(){i.Offline.check()}),c=s.register("offline.sync.menu",{type:"menu",title:"Synchronize"});c.menuSection(l),c.menuSection([{id:"changes.calcul",title:"Calcul Changes",offline:!1,action:function(){return o.sync()}},{id:"changes.reset",title:"Reset Offline Cache",offline:!1,action:function(){return o.reset()}}]),n.getById("file").menuSection([c],{position:10}),n.register("offline",{title:"Offline",position:90,offline:!0}).menuSection([l]),setInterval(function(){o.autoSync()},3e5),t.on("box:watch",function(){o.autoSync()}),setTimeout(function(){o.sync()},5e3)})